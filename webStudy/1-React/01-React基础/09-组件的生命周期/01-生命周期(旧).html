<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>声明周期 (旧)</title>
</head>

<body>
<div id="example"></div>

<script type="text/javascript" src="../js/react.development.js"></script>
<script type="text/javascript" src="../js/react-dom.development.js"></script>
<script type="text/javascript" src="../js/babel.min.js"></script>

<script type="text/babel">
	class Life extends React.Component {
		state = {
			opacity: 1
		}

		// 关闭定时器
		close = () => {
			ReactDOM.unmountComponentAtNode(document.getElementById('example'))
		}

		componentWillUnmount() {
			clearInterval(this.timer)
        }

		componentDidMount () {
			this.timer = setInterval(() => {
				let { opacity } = this.state
				opacity = opacity - 0.1
				if (opacity <= 0) opacity = 1
				this.setState({ opacity })
			}, 200)
		}

		render () {
			return (
				<div>
					<h2 style={{ opacity: this.state.opacity }}>今天睡太久了</h2>
					<button onClick={this.close}>关闭</button>
				</div>
			)
		}
	}

	ReactDOM.render(<Life/>, document.getElementById('example'))
</script>
</body>

</html>
